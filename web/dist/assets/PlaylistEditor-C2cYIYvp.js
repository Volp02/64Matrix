import{_ as b,c as r,a as s,w as y,v as h,F as v,r as _,e as f,t as m,b as g,d as p,o as c}from"./index-BUyM0YGx.js";const k={name:"PlaylistEditor",data(){return{playlistId:null,playlistName:"My New Playlist",items:[],availableScenes:[]}},computed:{totalDuration(){return this.items.reduce((e,t)=>e+(t.duration||10),0)}},async mounted(){await this.fetchScenes();const e=this.$route.params.id;e&&await this.loadPlaylist(e)},methods:{async loadPlaylist(e){try{const d=((await p.getPlaylists()).data.playlists||{})[e];d&&(this.playlistId=d.id,this.playlistName=d.name,this.items=d.items.map(o=>({...o})))}catch(t){console.error("Failed to load playlist",t)}},async fetchScenes(){try{const e=await p.getScenes();this.availableScenes=e.data.scenes}catch(e){console.error("Failed to load scenes",e)}},addItem(e){this.items.push({filename:e.filename,type:e.type,name:e.name,duration:10})},removeItem(e){this.items.splice(e,1)},moveItem(e,t){if(e+t<0||e+t>=this.items.length)return;const l=this.items[e];this.items.splice(e,1),this.items.splice(e+t,0,l)},onDragStart(e,t){e.dataTransfer.setData("scene",JSON.stringify(t))},onDrop(e){const t=e.dataTransfer.getData("scene");if(t){const l=JSON.parse(t);this.addItem(l)}},async savePlaylist(){if(!this.playlistName)return alert("Please name your playlist");const t={id:this.playlistId||this.playlistName.toLowerCase().replace(/[^a-z0-9]/g,"_"),name:this.playlistName,items:this.items.map(l=>({filename:l.filename,type:l.type,duration:l.duration}))};try{await p.savePlaylist(t),alert("Playlist Saved!"),this.$router.push("/playlists")}catch(l){alert("Failed to save: "+l)}}}},D={class:"playlist-editor"},S={class:"editor-header"},P={class:"actions"},N={class:"editor-workspace"},C={class:"column source-column"},I={class:"scene-list"},w=["onDragstart"],F={class:"scene-type"},V={class:"scene-name"},B=["onClick"],T={key:0,class:"empty-state"},E={class:"timeline-list"},L={class:"card-header"},M={class:"item-index"},U={class:"scene-name"},J=["onClick"],O={class:"card-controls"},q=["onUpdate:modelValue"],z={class:"order-controls"},A=["onClick","disabled"],j=["onClick","disabled"];function G(e,t,l,d,o,i){return c(),r("div",D,[s("header",S,[y(s("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>o.playlistName=a),placeholder:"Playlist Name",class:"name-input"},null,512),[[h,o.playlistName]]),s("div",P,[s("button",{onClick:t[1]||(t[1]=(...a)=>i.savePlaylist&&i.savePlaylist(...a)),class:"save-btn"},"ðŸ’¾ Save Playlist"),s("button",{onClick:t[2]||(t[2]=a=>e.$router.push("/library")),class:"cancel-btn"}," Back to Library ")])]),s("div",N,[s("div",C,[t[5]||(t[5]=s("h3",null,"Available Scenes",-1)),s("div",I,[(c(!0),r(v,null,_(o.availableScenes,a=>(c(),r("div",{key:a.filename,class:"scene-card source-card",draggable:"true",onDragstart:n=>i.onDragStart(n,a)},[s("span",F,m(a.type),1),s("span",V,m(a.name),1),s("button",{class:"add-btn",onClick:n=>i.addItem(a)},"+",8,B)],40,w))),128))])]),s("div",{class:"column timeline-column",onDragover:t[3]||(t[3]=f(()=>{},["prevent"])),onDrop:t[4]||(t[4]=(...a)=>i.onDrop&&i.onDrop(...a))},[s("h3",null,"Sequence Timeline ("+m(i.totalDuration)+"s)",1),o.items.length===0?(c(),r("div",T," Drag scenes here or click '+' to add to playlist ")):g("",!0),s("div",E,[(c(!0),r(v,null,_(o.items,(a,n)=>(c(),r("div",{key:n,class:"scene-card timeline-card"},[s("div",L,[s("span",M,m(n+1)+".",1),s("span",U,m(a.name||a.filename),1),s("button",{class:"remove-btn",onClick:u=>i.removeItem(n)},"âŒ",8,J)]),s("div",O,[t[6]||(t[6]=s("label",null,"Duration (s):",-1)),y(s("input",{type:"number","onUpdate:modelValue":u=>a.duration=u,min:"1",class:"duration-input"},null,8,q),[[h,a.duration,void 0,{number:!0}]]),s("div",z,[s("button",{onClick:u=>i.moveItem(n,-1),disabled:n===0}," â–² ",8,A),s("button",{onClick:u=>i.moveItem(n,1),disabled:n===o.items.length-1}," â–¼ ",8,j)])])]))),128))])],32)])])}const K=b(k,[["render",G],["__scopeId","data-v-93942824"]]);export{K as default};
